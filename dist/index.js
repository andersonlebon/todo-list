(()=>{"use strict";function e(e){return e.sort(((e,t)=>e.index-t.index))}function t(e){e.forEach((e=>{e.addEventListener("dragstart",(()=>{e.classList.add("dragging")})),e.addEventListener("dragend",(()=>{e.classList.remove("dragging")}))}))}function l(e){let t;e.forEach((e=>{let l=!0;const a=e.parentElement;e.addEventListener("click",(()=>{if(e.checked=l,e.checked){a.classList.add("done");const e=s.getDataAll()||[],l=s.getData(a.id);l.completed=!0,e.splice(a.id,1,l),s.storeData(e),t=!0}else{a.classList.remove("done"),t=!1;const e=s.getDataAll()||[],l=s.getData(a.id);l.completed=!1,e.splice(a.id,1,l),s.storeData(e)}l=!l;const n=a.parentElement;let c=n.querySelector(".clearMarked");if(null===c){const e=document.createElement("li");e.className="clearMarked list-group-item  text-center",e.innerHTML="Clear all Completed",n.appendChild(e),e.addEventListener("click",(()=>{const e=n.querySelectorAll(".done");let t=s.getDataAll();e.forEach((e=>{t=t.filter((t=>t.index!=e.id)),n.removeChild(e)})),localStorage.setItem("tasks",JSON.stringify(t))}))}if(a.parentElement.querySelectorAll(".ckeck-btn").forEach((e=>{e.checked&&(t=!0)})),c=document.querySelector(".none"),!t&&null==c){const e=n.querySelector(".clearMarked");n.removeChild(e)}t=!1}))}))}function a(e){e.forEach((e=>{e.addEventListener("click",(()=>{const t=e.parentElement.querySelector(".modify-task");t.classList.add("d-flex"),t.classList.add("justify-content-between"),t.classList.remove("d-none");const l=t.parentElement,a=l.querySelector(".input-mod"),n=s.getData(l.id);a.value=n.description}))}))}function n(e,t){e.forEach((e=>{e.addEventListener("click",(()=>{const a=e.parentElement,n=a.parentElement.querySelector("input"),c=a.parentElement.parentElement,r=s.getData(c.id);r.description=n.value;const d=s.getDataAll();d.splice(c.id,1,r),s.storeData(d);const o=t.querySelector(".add-taskInput"),i=t.querySelector(".title");t.innerHTML="",t.appendChild(i),t.appendChild(o),s.displayTask(t),l(document.querySelectorAll(".draggable .ckeck-btn")),a.parentElement.classList.remove("d-flex"),a.parentElement.classList.add("d-none")}))}))}function c(e,t){e.forEach((e=>{e.addEventListener("click",(()=>{const a=e.parentElement,n=a.parentElement.parentElement,c=s.getDataAll();1===c.length?s.storeData([]):(c.splice(n.id,1),s.storeData(c));const r=t.querySelector(".add-taskInput"),d=t.querySelector(".title");t.innerHTML="",t.appendChild(d),t.appendChild(r),s.displayTask(t),l(document.querySelectorAll(".draggable .ckeck-btn")),a.parentElement.classList.remove("d-flex"),a.parentElement.classList.add("d-none")}))}))}class s{static getDataAll(){return JSON.parse(localStorage.getItem("tasks"))}static storeData(e){localStorage.setItem("tasks",JSON.stringify(e))}static getData(t){return e(s.getDataAll()).filter((e=>e.index==t))[0]}static updateTasks(e){const t=s.getDataAll()||[];let l=s.getData(e.id);l=e,t.splice(e.id,1,l),s.storeData(t)}static displayTask(t){const l=s.getDataAll()||[];null!==l&&e(l),l.forEach((e=>{const l=document.createElement("li");l.draggable=!0,l.id=e.index;const a=e.completed?"checked":"unchecked";l.className="list-group-item d-flex draggable",l.innerHTML=`<input class="form-check-input ckeck-btn ml-auto" ${a} type="checkbox" id="check">\n      <div class="pl-3 text">${e.description}</div > \n      <span class="justify-self-end mr-auto plus"> <i class="fa fa-ellipsis-v"></i></span>\n      `;const n=document.createElement("div");n.innerHTML='<input class="input-mod" type="text" placeholder="Modify task..."/>\n                                  <div class="d-flex justify-content-end align-items-center"> \n                                  <span class="save-text"><i class="fa fa-check-circle " ></i></span>\n                                  <span class="delete"><i class="fa fa-trash"></i></span>\n                                  </div>',n.className="modify-task d-none";const c=l.querySelector("input");l.appendChild(n),c.checked?l.classList.add("done"):l.classList.remove("done"),t.appendChild(l)}));const r=document.querySelector(".list");a(document.querySelectorAll(".plus")),c(document.querySelectorAll(".delete"),r),n(document.querySelectorAll(".save-text"),r)}}const r=document.querySelector(".list"),d=document.querySelector(".add-icon"),o=document.querySelector(".add-taskInput input"),i=s.getDataAll();let u=0;null!==i&&i.forEach((e=>{e.index=u,u+=1})),s.storeData(i),s.displayTask(r);const p=document.querySelectorAll(".draggable"),m=document.querySelectorAll(".draggable .ckeck-btn");t(p),l(m),p.forEach((e=>{e.addEventListener("click",(()=>{}))})),r.addEventListener("dragover",(e=>{e.preventDefault();const t=document.querySelector(".dragging"),l=(a=r,n=e.clientY,[...a.querySelectorAll(".draggable:not(.dragging)")].reduce(((e,t)=>{const l=t.getBoundingClientRect(),a=n-l.top-l.height/2;return a<0&&a>e.offset?{offset:a,element:t}:e}),{offset:Number.NEGATIVE_INFINITY}).element);var a,n;null==l?r.appendChild(t):(l.classList.add("previousDrag"),r.insertBefore(t,l),l.classList.remove("previousDrag"))})),d.addEventListener("click",(()=>{!function(e,t,l){const a=l.getDataAll()||[],n={description:e,completed:!1,index:a.length};a.push(n),l.storeData(a);const c=t.querySelector(".add-taskInput"),s=t.querySelector(".title");t.innerHTML="",t.appendChild(s),t.appendChild(c)}(o.value,r,s),s.displayTask(r);const e=document.querySelectorAll(".draggable"),d=document.querySelectorAll(".draggable .ckeck-btn"),i=document.querySelectorAll(".save-text"),u=document.querySelectorAll(".plus");c(document.querySelectorAll(".delete"),r),n(i,r),a(u),t(e),l(d)})),a(document.querySelectorAll(".plus")),n(document.querySelectorAll(".save-text"),r)})();